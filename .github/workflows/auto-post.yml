name: Auto Post Jokes & Memes

on:
  schedule:
    # Post 6 times per day at optimal times (UTC)
    # Times shown are for IST (UTC+5:30):
    # 2:30 AM UTC = 8:00 AM IST (Morning)
    # 5:30 AM UTC = 11:00 AM IST (Mid-Morning)
    # 8:30 AM UTC = 2:00 PM IST (Afternoon)
    # 11:30 AM UTC = 5:00 PM IST (Evening)
    # 14:30 PM UTC = 8:00 PM IST (Night - PEAK TIME!)
    # 17:30 PM UTC = 11:00 PM IST (Late Night)
    - cron: '30 2,5,8,11,14,17 * * *'
  
  workflow_dispatch:  # Allow manual trigger


jobs:
  post-joke:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Post joke/meme to Telegram
      env:
        BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
        CHAT_ID: ${{ secrets.CHAT_ID }}
        TIMEZONE_OFFSET_HOURS: ${{ secrets.TIMEZONE_OFFSET_HOURS }}
      run: |
        python -m src.main
